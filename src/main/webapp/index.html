<!DOCTYPE html>
<html lang="en" style="">
<head>
    <meta charset="UTF-8">

    <title>Websocket测试</title>


</head>
<body >
<div>
    <h1 id="textH1"></h1>
</div>
<script src="static/js/jquery.min.js"></script>
<script>
    var date = {
        "direction":"cToS",
        "requestMethod":"pong",
        "responseType":"",
        "data":"",
        "time":1111
    };

    var ws = new WebSocket("ws://localhost:8080/websocket/1");

    ws.onopen = function(evt) {
        console.log("Connection open ...");
        var date = {
            "direction":"cToS",
            "requestMethod":"test",
            "responseType":"",
            "data":"",
            "time":1111
        };
    };

    ws.onmessage = function(evt) {
        // console.log("Received Message: " + evt.data);
        var responseData =  evt.data;
        var work2 = JSON.parse(responseData);
        var responseType = work2.responseType;
        // console.log("responseType: " + responseType);
        if(responseType == 'ping'){
            ws.send(JSON.stringify(date));
        }else {
            console.log(work2.data.data);
            $('#textH1').append(work2.data.data.id + ", " + work2.data.data.target + "</br>");
        }
    };

    ws.onclose = function(evt) {
        console.log("Connection closed.");
        setTimeout(function () {
            ws = new WebSocket("ws://localhost:8080/websocket/1");
        },5000);
    };


</script>
</body>
</html>
